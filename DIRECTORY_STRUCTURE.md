# Directory Structure

This document provides a comprehensive overview of the AI Agent Orchestrator project structure.

## Complete Directory Tree

```
ai-agent-orchestrator/
‚îú‚îÄ‚îÄ üìÅ src/                           # Source code directory
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ config/                    # Configuration management
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ üìÑ index.ts               # Central configuration file
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ modules/                   # Core system modules
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÑ AgentMaster.ts         # Central orchestration component
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÑ FunctionsManager.ts    # Custom functions management
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÑ MessagingManager.ts    # RabbitMQ messaging handler
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÑ JobsQueueManager.ts    # Job scheduling and execution
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ üìÑ LLMManager.ts          # LLM provider management
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ functions/                 # Custom function definitions
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÅ helper/                # Helper functions (utilities)
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÑ stringUtils.ts     # String manipulation functions
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÑ mathUtils.ts       # Mathematical utility functions
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ üìÑ [custom].ts        # Additional helper functions
‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÅ runner/                # Runner functions (schedulable)
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÑ timerFunction.ts   # Timer and delay functions
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ üìÑ [custom].ts        # Additional runner functions
‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ üìÅ worker/                # Worker functions (LLM-enabled)
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ üìÑ weatherFunction.ts # Weather API integration
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ üìÑ sentimentAnalysis.ts # AI sentiment analysis
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ üìÑ [custom].ts        # Additional worker functions
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ types/                     # TypeScript type definitions
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ üìÑ index.ts               # Central type definitions
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ utils/                     # Utility functions and helpers
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÑ logger.ts              # Winston logging configuration
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ üìÑ [helpers].ts           # Additional utility functions
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ üìÑ index.ts                   # Application entry point
‚îÇ
‚îú‚îÄ‚îÄ üìÅ public/                        # Static web assets
‚îÇ   ‚îî‚îÄ‚îÄ üìÅ testing/                   # Web testing interface
‚îÇ       ‚îú‚îÄ‚îÄ üìÑ index.html             # Testing UI main page
‚îÇ       ‚îú‚îÄ‚îÄ üìÑ style.css              # UI styling (optional)
‚îÇ       ‚îî‚îÄ‚îÄ üìÑ script.js              # UI JavaScript (optional)
‚îÇ
‚îú‚îÄ‚îÄ üìÅ dist/                          # Compiled TypeScript output
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ config/
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ modules/
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ functions/
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ types/
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ utils/
‚îÇ   ‚îî‚îÄ‚îÄ üìÑ index.js
‚îÇ
‚îú‚îÄ‚îÄ üìÅ logs/                          # Application log files
‚îÇ   ‚îú‚îÄ‚îÄ üìÑ app.log                    # General application logs
‚îÇ   ‚îú‚îÄ‚îÄ üìÑ error.log                  # Error-specific logs
‚îÇ   ‚îî‚îÄ‚îÄ üìÑ access.log                 # HTTP access logs (optional)
‚îÇ
‚îú‚îÄ‚îÄ üìÅ node_modules/                  # NPM dependencies
‚îÇ
‚îú‚îÄ‚îÄ üìÅ docs/                          # Additional documentation
‚îÇ   ‚îú‚îÄ‚îÄ üìÑ API.md                     # API documentation
‚îÇ   ‚îú‚îÄ‚îÄ üìÑ FUNCTIONS.md               # Function development guide
‚îÇ   ‚îî‚îÄ‚îÄ üìÑ DEPLOYMENT.md              # Deployment instructions
‚îÇ
‚îú‚îÄ‚îÄ üìÅ tests/                         # Test files (optional)
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ unit/
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ integration/
‚îÇ   ‚îî‚îÄ‚îÄ üìÑ setup.ts
‚îÇ
‚îú‚îÄ‚îÄ üìÑ package.json                   # NPM package configuration
‚îú‚îÄ‚îÄ üìÑ package-lock.json              # NPM lock file
‚îú‚îÄ‚îÄ üìÑ tsconfig.json                  # TypeScript configuration
‚îú‚îÄ‚îÄ üìÑ .env                           # Environment variables (local)
‚îú‚îÄ‚îÄ üìÑ .env.example                   # Environment template
‚îú‚îÄ‚îÄ üìÑ .gitignore                     # Git ignore rules
‚îú‚îÄ‚îÄ üìÑ README.md                      # Main documentation
‚îú‚îÄ‚îÄ üìÑ SETUP.md                       # Setup instructions
‚îú‚îÄ‚îÄ üìÑ DIRECTORY_STRUCTURE.md         # This file
‚îî‚îÄ‚îÄ üìÑ LICENSE                        # Software license
```

## Directory Descriptions

### üìÅ `/src` - Source Code
Main application source code written in TypeScript.

**Key Files:**
- `index.ts` - Application entry point, server setup, and middleware configuration

### üìÅ `/src/config` - Configuration Management
Centralized configuration system for all modules.

**Key Files:**
- `index.ts` - Main configuration file that loads environment variables and provides typed configuration objects

**Purpose:**
- Environment variable management
- Default value handling
- Configuration validation
- Centralized settings access

### üìÅ `/src/modules` - Core System Modules
The five main modules that form the backbone of the system.

#### AgentMaster.ts
- Central orchestration component
- Handles message routing and processing
- Contains OrchestrationMaster LLM logic
- Coordinates all other modules

#### FunctionsManager.ts
- Loads and manages custom functions
- Validates function definitions
- Executes functions with timeout handling
- Provides function hot-reloading

#### MessagingManager.ts
- RabbitMQ integration and message handling
- Message validation and acknowledgment
- Queue management and connection handling
- Event-driven message processing

#### JobsQueueManager.ts
- Job scheduling and execution with Bull.js
- Supports instant, scheduled, and repeated jobs
- Job status tracking and management
- Redis-based persistence

#### LLMManager.ts
- Multi-provider LLM integration
- Instance management and configuration
- Usage tracking and health monitoring
- Automatic cleanup and optimization

### üìÅ `/src/functions` - Custom Functions
User-defined functions organized by type.

#### üìÅ `/helper` - Helper Functions
- Pure utility functions
- Cannot import runner/worker functions
- Used for data processing and transformation
- Examples: string manipulation, math operations

#### üìÅ `/runner` - Runner Functions  
- Functions that can be scheduled or repeated
- Can import helper functions
- Used for recurring tasks and scheduled operations
- Examples: cleanup tasks, periodic checks

#### üìÅ `/worker` - Worker Functions
- Functions that can create LLM instances
- Can import helper functions
- Used for AI-powered operations
- Examples: data analysis, content generation

**Function File Structure:**
```typescript
// Standard function export pattern
import { ICustomFunction, FunctionType } from '../../types';

const functionName: ICustomFunction = {
  definition: {
    name: 'functionName',
    description: 'Function description',
    type: FunctionType.HELPER, // or RUNNER, WORKER
    parameters: [...],
    timeout: 30000
  },
  handler: async (params, context) => {
    // Function implementation
    return result;
  }
};

export default functionName;
```

### üìÅ `/src/types` - Type Definitions
TypeScript interfaces and types for the entire application.

**Key Types:**
- Function-related interfaces (ICustomFunction, IFunctionDefinition)
- Job-related interfaces (IJob, IJobData, JobStatus)
- Message interfaces (IIncomingMessage, IOutgoingMessage)
- LLM interfaces (ILLMConfig, ILLMResponse)
- System interfaces (IHealthStatus, IExecutionContext)

### üìÅ `/src/utils` - Utility Functions
Shared utility functions and helpers.

**Key Files:**
- `logger.ts` - Winston-based logging configuration with multiple transports

### üìÅ `/public` - Static Web Assets
Web-based testing interface and static files.

#### üìÅ `/testing` - Web Testing Interface
- Complete HTML/CSS/JS testing application
- Real-time system monitoring
- Function definition viewer
- Message template system
- Interactive console with logs

**Features:**
- Status light indicators for all modules
- JSON message editor with templates
- Response viewer with copy functionality
- Real-time system logs and monitoring
- Function definition popup modals

### üìÅ `/dist` - Compiled Output
TypeScript compilation output (created by `npm run build`).

**Auto-generated files:**
- JavaScript equivalents of all TypeScript files
- Source maps for debugging
- Declaration files for type information

### üìÅ `/logs` - Application Logs
Runtime log files created by the Winston logger.

**Log Files:**
- `app.log` - General application logs (all levels)
- `error.log` - Error-specific logs only
- Rotated log files (when rotation is enabled)

### üìÅ `/node_modules` - Dependencies
NPM package dependencies (auto-generated by `npm install`).

## File Naming Conventions

### TypeScript Files
- **PascalCase** for classes and modules: `AgentMaster.ts`
- **camelCase** for utilities and functions: `stringUtils.ts`
- **lowercase** for configuration: `index.ts`

### Directory Names
- **lowercase** with hyphens for multi-word: `test-results/`
- **camelCase** for single concepts: `functions/`

### Environment Files
- `.env` - Local environment variables
- `.env.example` - Template with example values
- `.env.production` - Production-specific variables

## Import Patterns

### Module Imports
```typescript
// Relative imports within same directory level
import { logger } from '../utils/logger';

// Named imports for specific functionality
import { ICustomFunction, FunctionType } from '../../types';

// Default imports for modules
import AgentMaster from './modules/AgentMaster';
```

### Function Imports
```typescript
// Helper functions can be imported by any type
import stringUtils from '../helper/stringUtils';

// Worker functions can import helpers but not other workers
import mathUtils from '../helper/mathUtils';
```

## Build Output Structure

After running `npm run build`, the `/dist` directory mirrors the `/src` structure:

```
dist/
‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îî‚îÄ‚îÄ index.js
‚îú‚îÄ‚îÄ modules/
‚îÇ   ‚îú‚îÄ‚îÄ AgentMaster.js
‚îÇ   ‚îú‚îÄ‚îÄ FunctionsManager.js
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ functions/
‚îÇ   ‚îú‚îÄ‚îÄ helper/
‚îÇ   ‚îú‚îÄ‚îÄ runner/
‚îÇ   ‚îî‚îÄ‚îÄ worker/
‚îî‚îÄ‚îÄ index.js
```

## Development Workflow

### Adding New Functions
1. Create file in appropriate `/src/functions/[type]/` directory
2. Follow function template pattern
3. Export as default
4. System auto-loads on startup or reload

### Adding New Modules
1. Create in `/src/modules/`
2. Implement required interfaces
3. Add to AgentMaster initialization
4. Update health check endpoints

### Modifying Configuration
1. Update `/src/config/index.ts`
2. Add environment variables to `.env.example`
3. Update type definitions if needed
4. Document in setup guide

## Security Considerations

### File Permissions
```bash
# Secure log directory
chmod 750 logs/

# Protect environment file
chmod 600 .env

# Make scripts executable
chmod +x scripts/*.sh
```

### Sensitive Files
Files that should never be committed:
- `.env` (contains API keys)
- `logs/` (may contain sensitive data)
- `node_modules/` (large, generated)
- `dist/` (compiled output)

## Maintenance

### Regular Cleanup
```bash
# Clean compiled output
npm run clean

# Remove old logs
find logs/ -name "*.log" -mtime +30 -delete

# Update dependencies
npm audit && npm update
```

###